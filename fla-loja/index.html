<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loja Oficial do Flamengo - 80% OFF</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            overflow-x: hidden;
            overflow-y: auto;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: #f5f5f5;
            line-height: 1.6;
            height: auto;
            min-height: 100%;
            overflow-x: hidden;
            overflow-y: visible;
            -webkit-overflow-scrolling: touch;
            position: relative;
        }

        .navbar {
            background: #000;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            height: 50px;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-menu a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-menu a:hover {
            color: #E60026;
        }

        .nav-icons {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            color: white;
            font-size: 20px;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #E60026;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Welcome Section */
        .welcome-section {
            padding: 40px 20px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .welcome-container {
            background: #E60026;
            color: white;
            padding: 30px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 100%;
        }

        .hero-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            color: white;
        }

        .hero-subtitle {
            font-size: 16px;
            margin-bottom: 20px;
            color: white;
            opacity: 0.9;
        }

        .discount-badge {
            background: white;
            color: #E60026;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .shipping-info {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: bold;
        }

        /* Products Section */
        .products-section {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .section-title {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            text-align: center;
            margin-bottom: 40px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
        }

        .product-info {
            padding: 20px;
        }

        .product-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .product-prices {
            margin-bottom: 15px;
        }

        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 16px;
        }

        .sale-price {
            color: #E60026;
            font-size: 24px;
            font-weight: bold;
            margin-left: 10px;
        }

        .discount-percent {
            background: #E60026;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .add-to-cart-btn {
            background: #E60026;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s ease;
        }

        .add-to-cart-btn:hover {
            background: #B8001F;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-header {
            background: #E60026;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-title {
            font-size: 20px;
            font-weight: bold;
        }

        .close-cart {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .cart-content {
            padding: 20px;
        }

        .cart-item {
            display: flex;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            background: #f8f8f8;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #666;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: #E60026;
            font-weight: bold;
        }

        .cart-item-size {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .quantity-btn {
            background: #E60026;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity {
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }

        .cart-total {
            background: #f8f8f8;
            padding: 20px;
            margin-top: 20px;
            border-radius: 10px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .total-final {
            font-size: 20px;
            font-weight: bold;
            color: #E60026;
            border-top: 2px solid #E60026;
            padding-top: 10px;
        }

        .checkout-btn {
            background: #E60026;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: background 0.3s ease;
        }

        .checkout-btn:hover {
            background: #B8001F;
        }

        .empty-cart {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        /* Product Modal */
        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .modal-product-image {
            width: 100%;
            height: 300px;
            background: #f8f8f8;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 18px;
            color: #666;
        }

        .modal-product-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .modal-product-prices {
            margin-bottom: 20px;
        }

        .size-selector {
            margin-bottom: 20px;
        }

        .size-label {
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .size-options {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .size-option {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .size-option:hover,
        .size-option.selected {
            border-color: #E60026;
            background: #E60026;
            color: white;
        }

        .personalization {
            margin-bottom: 20px;
        }

        .personalization label {
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
        }

        .personalization select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .modal-add-to-cart {
            background: #E60026;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s ease;
        }

        .modal-add-to-cart:hover {
            background: #B8001F;
        }

        .modal-add-to-cart:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Success Message */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 3000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .success-message.show {
            transform: translateX(0);
        }

        /* Personalization Input Fields */
        .personalization-inputs {
            margin-top: 15px;
            display: none;
        }

        .personalization-inputs.show {
            display: block;
        }

        .personalization-inputs input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .personalization-inputs input:focus {
            border-color: #E60026;
            outline: none;
        }

        /* Cart Reminder */
        .cart-reminder {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #E60026;
            color: white;
            padding: 15px 20px;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            z-index: 1500;
            display: none;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        .cart-reminder:hover {
            background: #B8001F;
            transform: scale(1.05);
        }

        .cart-reminder.show {
            display: flex;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 5px 20px rgba(230, 0, 38, 0.3);
            }

            50% {
                box-shadow: 0 5px 30px rgba(230, 0, 38, 0.6);
            }

            100% {
                box-shadow: 0 5px 20px rgba(230, 0, 38, 0.3);
            }
        }

        /* Cart Item Image */
        .cart-item-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: contain;
            background: #f8f8f8;
            margin-right: 15px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .cart-item-details {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .cart-item-price {
            font-weight: bold;
            color: #E60026;
        }

        .remove-item {
            background: #ff4444;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .cart-item-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            background: #E60026;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-btn:hover {
            background: #B8001F;
        }

        .quantity {
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }

        /* Shipping Form Styles */
        .shipping-form {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #E60026;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: flex;
            gap: 10px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #E60026;
        }

        .form-group input[readonly] {
            background-color: #f5f5f5;
            color: #666;
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            font-size: 12px;
        }

        .form-group small.success {
            color: #4CAF50;
        }

        .form-group small.error {
            color: #ff4444;
        }

        .checkout-btn:disabled {
            background: #ccc !important;
            cursor: not-allowed !important;
        }

        /* Responsive */
        @media (max-width: 768px) {

            html,
            body {
                height: auto !important;
                min-height: 100vh;
                overflow-x: hidden;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                position: relative;
            }

            /* Evitar zoom em inputs no mobile */
            input, select, textarea {
                font-size: 16px !important;
            }

            /* Melhorar rolagem no formul√°rio de CEP */
            .form-group input {
                font-size: 16px !important;
            }

            .nav-menu {
                display: none;
            }

            .welcome-title {
                font-size: 24px;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }

            .modal-content {
                margin: 20px auto;
                width: 95%;
            }

            .size-options {
                justify-content: center;
            }

            .cart-reminder {
                bottom: 10px;
                right: 10px;
                padding: 12px 16px;
                font-size: 14px;
            }
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <img src="/quiz/img/fla-logo.png" alt="Flamengo" class="logo">

            <ul class="nav-menu">
                <li><a href="#produtos">Produtos</a></li>
                <li><a href="#masculino">Masculino</a></li>
                <li><a href="#feminino">Feminino</a></li>
                <li><a href="#acessorios">Acess√≥rios</a></li>
            </ul>

            <div class="nav-icons">
                <div class="cart-icon" onclick="toggleCart()">
                    üõí
                    <span class="cart-count" id="cartCount">0</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Welcome Section -->
    <section class="welcome-section">
        <div class="welcome-container">
            <h1 class="welcome-title" id="welcomeTitle">Parab√©ns, voc√™ recebeu 80% de desconto!</h1>
            <p class="welcome-subtitle">Aproveite esta oferta exclusiva na Loja Oficial do Flamengo</p>

            <div class="discount-badge">80% OFF</div>

            <div class="shipping-info" id="shippingInfo">
                <strong>üöö Frete gratuito dispon√≠vel para sua regi√£o!</strong>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products-section">
        <h2 class="section-title">Produtos com 80% de Desconto</h2>

        <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here by JavaScript -->
        </div>
    </section>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3 class="cart-title">Seu Carrinho</h3>
            <button class="close-cart" onclick="toggleCart()">√ó</button>
        </div>

        <div class="cart-content">
            <div id="cartItems">
                <div class="empty-cart">
                    <p>Seu carrinho est√° vazio</p>
                    <p>Adicione produtos para continuar</p>
                </div>
            </div>

            <div class="cart-total" id="cartTotal" style="display: none;">
                <!-- Formul√°rio de Endere√ßo -->
                <div class="shipping-form" id="shippingForm">
                    <h4 style="margin-bottom: 15px; color: #E60026; font-weight: bold;">üìç Dados de Entrega</h4>
                    
                    <div class="form-group">
                        <label for="cep">CEP:</label>
                        <input type="text" id="cep" placeholder="00000-000" maxlength="9" onkeyup="formatCep(this)" onblur="buscarCep()">
                        <small id="cepStatus" style="display: none;"></small>
                    </div>
                    
                    <!-- Campos que aparecem ap√≥s buscar CEP -->
                    <div id="addressFields" style="display: none;">
                        <div class="form-group">
                            <label for="rua">Rua:</label>
                            <input type="text" id="rua" placeholder="Nome da rua" readonly>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label for="numero">N√∫mero:</label>
                                <input type="text" id="numero" placeholder="123">
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="complemento">Complemento:</label>
                                <input type="text" id="complemento" placeholder="Apto 45">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="bairro">Bairro:</label>
                            <input type="text" id="bairro" placeholder="Nome do bairro" readonly>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group" style="flex: 2;">
                                <label for="cidade">Cidade:</label>
                                <input type="text" id="cidade" placeholder="Nome da cidade" readonly>
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label for="estado">Estado:</label>
                                <input type="text" id="estado" placeholder="UF" readonly>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="total-row">
                    <span>Subtotal:</span>
                    <span id="subtotal">R$ 0,00</span>
                </div>
                <div class="total-row">
                    <span>Desconto (80%):</span>
                    <span id="discount" style="color: #4CAF50;">-R$ 0,00</span>
                </div>
                <div class="total-row">
                    <span>Frete:</span>
                    <span style="color: #4CAF50;">GR√ÅTIS</span>
                </div>
                <div class="total-row total-final">
                    <span>Total:</span>
                    <span id="finalTotal">R$ 0,00</span>
                </div>

                <button class="checkout-btn" onclick="checkout()" id="checkoutBtn" disabled>
                    FINALIZAR COMPRA
                </button>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div class="product-modal" id="productModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeProductModal()">√ó</button>

            <div class="modal-product-image" id="modalProductImage">
                Imagem do Produto
            </div>

            <h3 class="modal-product-name" id="modalProductName"></h3>

            <div class="modal-product-prices">
                <span class="original-price" id="modalOriginalPrice"></span>
                <span class="sale-price" id="modalSalePrice"></span>
                <span class="discount-percent">80% OFF</span>
            </div>

            <div class="size-selector">
                <label class="size-label">Tamanho:</label>
                <div class="size-options" id="sizeOptions">
                    <div class="size-option" data-size="P">P</div>
                    <div class="size-option" data-size="M">M</div>
                    <div class="size-option" data-size="G">G</div>
                    <div class="size-option" data-size="GG">GG</div>
                    <div class="size-option" data-size="2GG">2GG</div>
                    <div class="size-option" data-size="3GG">3GG</div>
                </div>
            </div>

            <div class="personalization">
                <label for="personalizacao">Personalizar Camisa:</label>
                <select id="personalizacao" onchange="togglePersonalizationInputs()">
                    <option value="">Sem personaliza√ß√£o</option>
                    <option value="nome">Nome personalizado (+R$ 20,00)</option>
                    <option value="numero">N√∫mero personalizado (+R$ 15,00)</option>
                    <option value="nome-numero">Nome + N√∫mero (+R$ 30,00)</option>
                </select>

                <div class="personalization-inputs" id="personalizationInputs">
                    <input type="text" id="nomePersonalizado" placeholder="Digite o nome desejado" maxlength="12"
                        style="display: none;">
                    <input type="number" id="numeroPersonalizado" placeholder="Digite o n√∫mero (1-99)" min="1" max="99"
                        style="display: none;">
                </div>
            </div>

            <div class="personalization">
                <label for="patrocinios">Incluir Patroc√≠nios:</label>
                <select id="patrocinios">
                    <option value="sim">Com patroc√≠nios</option>
                    <option value="nao">Sem patroc√≠nios</option>
                </select>
            </div>

            <button class="modal-add-to-cart" id="modalAddToCart" onclick="addToCartFromModal()" disabled>
                ADICIONAR AO CARRINHO
            </button>
        </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
        ‚úÖ Produto adicionado ao carrinho!
    </div>

    <!-- Cart Reminder -->
    <div class="cart-reminder" id="cartReminder" onclick="toggleCart()">
        üõí <span id="reminderText">Voc√™ tem itens no carrinho!</span>
    </div>

    <script>
        // Products data
        const products = [
            {
                id: 1,
                name: "Camiseta de Jogo Flamengo 2025",
                originalPrice: 399.90,
                salePrice: 79.98,
                image: "camiseta1.png",
                category: "Camiseta Oficial"
            },
            {
                id: 2,
                name: "Jaqueta Flamengo Oficial",
                originalPrice: 599.90,
                salePrice: 119.98,
                image: "jaquetaflamengo.webp",
                category: "Jaqueta Oficial"
            },
            {
                id: 3,
                name: "Bermuda Flamengo",
                originalPrice: 199.90,
                salePrice: 39.98,
                image: "bermudaflamengo.png",
                category: "Bermuda Oficial"
            },
            {
                id: 4,
                name: "Camiseta Flamengo 2 - Away",
                originalPrice: 399.90,
                salePrice: 79.98,
                image: "camiseta2.png",
                category: "Camiseta Away"
            },
            {
                id: 5,
                name: "Cal√ßa Flamengo Oficial",
                originalPrice: 399.90,
                salePrice: 79.98,
                image: "calcaflamengo.png",
                category: "Cal√ßa Oficial"
            },
            {
                id: 6,
                name: "Camiseta Manga Longa",
                originalPrice: 459.90,
                salePrice: 91.98,
                image: "camisetamangalonga.png",
                category: "Manga Longa"
            },
            {
                id: 7,
                name: "Kit Flamengo - Camiseta + Bermuda",
                originalPrice: 599.90,
                salePrice: 119.98,
                image: "kitflamengo.png",
                category: "Kit Completo"
            }
        ];

        let cart = [];
        let currentProduct = null;
        let selectedSize = null;

        // Load user data and update welcome message
        document.addEventListener('DOMContentLoaded', function () {
            const userData = JSON.parse(localStorage.getItem('userData') || '{}');

            if (userData.nome) {
                document.getElementById('welcomeTitle').textContent =
                    `Parab√©ns ${userData.nome.split(' ')[0]}, voc√™ recebeu 80% de desconto!`;
            }

            if (userData.estado) {
                document.getElementById('shippingInfo').innerHTML =
                    `<strong>üöö Frete gratuito dispon√≠vel para ${userData.estado}!</strong>`;
            }

            loadProducts();
        });

        // Load products
        function loadProducts() {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.onclick = () => openProductModal(product);

                productCard.innerHTML = `
                    <div class="product-image">
                        <img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: contain; object-position: center;">
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-prices">
                            <span class="original-price">R$ ${product.originalPrice.toFixed(2).replace('.', ',')}</span>
                            <span class="sale-price">R$ ${product.salePrice.toFixed(2).replace('.', ',')}</span>
                            <span class="discount-percent">80% OFF</span>
                        </div>
                        <button class="add-to-cart-btn" onclick="event.stopPropagation(); openProductModal(${JSON.stringify(product).replace(/"/g, '&quot;')})">
                            VER PRODUTO
                        </button>
                    </div>
                `;

                grid.appendChild(productCard);
            });
        }

        // Open product modal
        function openProductModal(product) {
            currentProduct = product;
            selectedSize = null;

            document.getElementById('modalProductName').textContent = product.name;
            const modalImage = document.getElementById('modalProductImage');
            modalImage.innerHTML = `<img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: contain; object-position: center;">`;
            document.getElementById('modalOriginalPrice').textContent =
                `R$ ${product.originalPrice.toFixed(2).replace('.', ',')}`;
            document.getElementById('modalSalePrice').textContent =
                `R$ ${product.salePrice.toFixed(2).replace('.', ',')}`;

            // Reset size selection
            document.querySelectorAll('.size-option').forEach(option => {
                option.classList.remove('selected');
            });

            // Reset form
            document.getElementById('personalizacao').value = '';
            document.getElementById('patrocinios').value = 'sim';

            // Hide personalization for specific products (jaqueta, bermuda, cal√ßa)
            const personalizationDiv = document.querySelector('.personalization');
            const patrociniosDiv = document.querySelector('.personalization:last-of-type');
            
            if (product.name.toLowerCase().includes('jaqueta') || 
                product.name.toLowerCase().includes('bermuda') || 
                product.name.toLowerCase().includes('cal√ßa')) {
                personalizationDiv.style.display = 'none';
                patrociniosDiv.style.display = 'none';
            } else {
                personalizationDiv.style.display = 'block';
                patrociniosDiv.style.display = 'block';
            }

            updateModalAddButton();
            document.getElementById('productModal').style.display = 'block';
        }

        // Close product modal
        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
            currentProduct = null;
            selectedSize = null;
        }

        // Size selection
        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('size-option')) {
                document.querySelectorAll('.size-option').forEach(option => {
                    option.classList.remove('selected');
                });
                e.target.classList.add('selected');
                selectedSize = e.target.dataset.size;
                updateModalAddButton();
            }
        });

        // Toggle personalization inputs
        function togglePersonalizationInputs() {
            const select = document.getElementById('personalizacao');
            const inputsContainer = document.getElementById('personalizationInputs');
            const nomeInput = document.getElementById('nomePersonalizado');
            const numeroInput = document.getElementById('numeroPersonalizado');

            // Hide all inputs first
            nomeInput.style.display = 'none';
            numeroInput.style.display = 'none';
            inputsContainer.classList.remove('show');

            // Show relevant inputs based on selection
            if (select.value === 'nome') {
                nomeInput.style.display = 'block';
                inputsContainer.classList.add('show');
            } else if (select.value === 'numero') {
                numeroInput.style.display = 'block';
                inputsContainer.classList.add('show');
            } else if (select.value === 'nome-numero') {
                nomeInput.style.display = 'block';
                numeroInput.style.display = 'block';
                inputsContainer.classList.add('show');
            }
        }

        // Update modal add button
        function updateModalAddButton() {
            const button = document.getElementById('modalAddToCart');
            if (selectedSize) {
                button.disabled = false;
                button.textContent = 'ADICIONAR AO CARRINHO';
            } else {
                button.disabled = true;
                button.textContent = 'SELECIONE UM TAMANHO';
            }
        }

        // Add to cart from modal
        function addToCartFromModal() {
            if (!currentProduct || !selectedSize) return;

            const personalizacao = document.getElementById('personalizacao').value;
            const patrocinios = document.getElementById('patrocinios').value;
            const nomePersonalizado = document.getElementById('nomePersonalizado').value;
            const numeroPersonalizado = document.getElementById('numeroPersonalizado').value;

            let extraCost = 0;
            let personalizacaoText = '';

            if (personalizacao === 'nome') {
                extraCost = 20;
                personalizacaoText = nomePersonalizado ? `Nome: ${nomePersonalizado}` : 'Nome personalizado';
            } else if (personalizacao === 'numero') {
                extraCost = 15;
                personalizacaoText = numeroPersonalizado ? `N√∫mero: ${numeroPersonalizado}` : 'N√∫mero personalizado';
            } else if (personalizacao === 'nome-numero') {
                extraCost = 30;
                const nome = nomePersonalizado || 'Nome';
                const numero = numeroPersonalizado || 'N√∫mero';
                personalizacaoText = `${nome} - ${numero}`;
            }

            const cartItem = {
                id: Date.now(),
                productId: currentProduct.id,
                name: currentProduct.name,
                price: currentProduct.salePrice + extraCost,
                originalPrice: currentProduct.originalPrice + extraCost,
                size: selectedSize,
                personalizacao: personalizacaoText,
                patrocinios: patrocinios,
                quantity: 1,
                image: currentProduct.image
            };

            cart.push(cartItem);
            updateCartDisplay();
            showSuccessMessage();
            showCartReminder();
            closeProductModal();
        }

        // Show success message
        function showSuccessMessage() {
            const message = document.getElementById('successMessage');
            message.classList.add('show');
            setTimeout(() => {
                message.classList.remove('show');
            }, 3000);
        }

        // Show cart reminder
        function showCartReminder() {
            const reminder = document.getElementById('cartReminder');
            const reminderText = document.getElementById('reminderText');

            if (cart.length > 0) {
                reminderText.textContent = cart.length === 1
                    ? 'Voc√™ tem 1 item no carrinho!'
                    : `Voc√™ tem ${cart.length} itens no carrinho!`;
                reminder.classList.add('show');
            } else {
                reminder.classList.remove('show');
            }
        }

        // Toggle cart
        function toggleCart() {
            const sidebar = document.getElementById('cartSidebar');
            const reminder = document.getElementById('cartReminder');
            
            sidebar.classList.toggle('open');
            
            // Esconder mensagem quando carrinho aberto, mostrar quando fechado
            if (sidebar.classList.contains('open')) {
                reminder.classList.remove('show');
            } else if (cart.length > 0) {
                reminder.classList.add('show');
            }
        }

        // Update cart display
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const cartCount = document.getElementById('cartCount');

            cartCount.textContent = cart.length;

            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <p>Seu carrinho est√° vazio</p>
                        <p>Adicione produtos para continuar</p>
                    </div>
                `;
                cartTotal.style.display = 'none';
                return;
            }

            cartItems.innerHTML = '';
            let subtotal = 0;
            let originalTotal = 0;

            cart.forEach((item, index) => {
                subtotal += item.price * item.quantity;
                originalTotal += item.originalPrice * item.quantity;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-details">Tamanho: ${item.size}</div>
                        ${item.personalizacao ? `<div class="cart-item-details">Personaliza√ß√£o: ${item.personalizacao}</div>` : ''}
                        <div class="cart-item-price">R$ ${item.price.toFixed(2).replace('.', ',')}</div>
                    </div>
                    <div class="cart-item-actions">
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                        </div>
                        <button class="remove-item" onclick="removeItem(${index})">Remover</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            const discount = originalTotal - subtotal;

            document.getElementById('subtotal').textContent = `R$ ${originalTotal.toFixed(2).replace('.', ',')}`;
            document.getElementById('discount').textContent = `-R$ ${discount.toFixed(2).replace('.', ',')}`;
            document.getElementById('finalTotal').textContent = `R$ ${subtotal.toFixed(2).replace('.', ',')}`;

            cartTotal.style.display = 'block';
        }

        // Update quantity
        function updateQuantity(index, change) {
            cart[index].quantity += change;
            if (cart[index].quantity <= 0) {
                cart.splice(index, 1);
            }
            updateCartDisplay();
            showCartReminder();
        }

        // Remove item
        function removeItem(index) {
            cart.splice(index, 1);
            updateCartDisplay();
            showCartReminder();
        }

        // Checkout
        function checkout() {
            if (cart.length === 0) return;
            
            // Validar endere√ßo antes de prosseguir
            if (!validateShippingForm()) {
                alert('Por favor, preencha todos os dados de entrega obrigat√≥rios.');
                return;
            }

            // Save cart data
            localStorage.setItem('cartData', JSON.stringify(cart));
            
            // Save shipping data
            const shippingData = {
                cep: document.getElementById('cep').value,
                rua: document.getElementById('rua').value,
                numero: document.getElementById('numero').value,
                complemento: document.getElementById('complemento').value,
                bairro: document.getElementById('bairro').value,
                cidade: document.getElementById('cidade').value,
                estado: document.getElementById('estado').value
            };
            localStorage.setItem('shippingData', JSON.stringify(shippingData));

            // Redirect to payment page
            window.location.href = 'pagamento.html' + window.location.search;
        }

        // Formatar CEP
        function formatCep(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 5) {
                value = value.substring(0, 5) + '-' + value.substring(5, 8);
            }
            input.value = value;
            
            // Validar se tem 8 d√≠gitos
            if (value.replace(/\D/g, '').length === 8) {
                buscarCep();
            }
        }

        // Buscar CEP via API
        async function buscarCep() {
            const cep = document.getElementById('cep').value.replace(/\D/g, '');
            const status = document.getElementById('cepStatus');
            const addressFields = document.getElementById('addressFields');
            
            if (cep.length !== 8) {
                status.style.display = 'none';
                addressFields.style.display = 'none';
                return;
            }

            status.style.display = 'block';
            status.textContent = 'üîç Buscando CEP...';
            status.className = '';

            try {
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                const data = await response.json();

                if (data.erro) {
                    status.textContent = '‚ùå CEP n√£o encontrado';
                    status.className = 'error';
                    addressFields.style.display = 'none';
                    clearAddressFields();
                } else {
                    status.textContent = '‚úÖ CEP encontrado';
                    status.className = 'success';
                    
                    // Preencher campos
                    document.getElementById('rua').value = data.logradouro || '';
                    document.getElementById('bairro').value = data.bairro || '';
                    document.getElementById('cidade').value = data.localidade || '';
                    document.getElementById('estado').value = data.uf || '';
                    
                    // Mostrar campos de endere√ßo
                    addressFields.style.display = 'block';
                    
                    // Focar no campo n√∫mero
                    setTimeout(() => {
                        document.getElementById('numero').focus();
                    }, 100);
                }
            } catch (error) {
                status.textContent = '‚ùå Erro ao buscar CEP';
                status.className = 'error';
                addressFields.style.display = 'none';
                clearAddressFields();
            }
            
            validateShippingForm();
        }

        // Limpar campos de endere√ßo
        function clearAddressFields() {
            document.getElementById('rua').value = '';
            document.getElementById('bairro').value = '';
            document.getElementById('cidade').value = '';
            document.getElementById('estado').value = '';
            document.getElementById('numero').value = '';
            document.getElementById('complemento').value = '';
            
            // Ocultar campos de endere√ßo
            document.getElementById('addressFields').style.display = 'none';
        }

        // Validar formul√°rio de entrega
        function validateShippingForm() {
            const cep = document.getElementById('cep').value.replace(/\D/g, '');
            const rua = document.getElementById('rua').value.trim();
            const numero = document.getElementById('numero').value.trim();
            const bairro = document.getElementById('bairro').value.trim();
            const cidade = document.getElementById('cidade').value.trim();
            const estado = document.getElementById('estado').value.trim();
            
            const isValid = cep.length === 8 && rua && numero && bairro && cidade && estado;
            
            const checkoutBtn = document.getElementById('checkoutBtn');
            checkoutBtn.disabled = !isValid;
            
            return isValid;
        }

        // Adicionar eventos de valida√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Adicionar eventos aos campos obrigat√≥rios
            const requiredFields = ['numero'];
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', validateShippingForm);
                    field.addEventListener('blur', validateShippingForm);
                }
            });
        });

        // Close modal when clicking outside
        window.onclick = function (event) {
            const modal = document.getElementById('productModal');
            if (event.target === modal) {
                closeProductModal();
            }
        }
    </script>
</body>

</html>